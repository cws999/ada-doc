<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Preconditions and Postconditions</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.WideHanging-Body {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.2em; margin-top: 0em; margin-bottom: 0.6em}
    DIV.WideHanging-Term {float: left; font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-top: 0em; margin-bottom: 0em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B></SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-6-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-6-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>6.1.1 Preconditions and Postconditions</H1>
<div class="paranum"><a name="p1">1/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">For a subprogram or 
entry, the following language-defined aspects may be specified with an 
<SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0306">aspect_specification</A></SPAN> 
(see <A HREF="RM-13-1-1.html">13.1.1</A>):</div>
<div class="paranum"><a name="p2">2/3</a></div>
<div class="WideHanging-Term">Pre</div><div class="WideHanging-Body">
This aspect specifies a specific precondition for a callable entity; 
it shall be specified by an <SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN>, 
called a <I>specific precondition expression</I>.<A NAME="I3338"></A><A NAME="I3339"></A> 
If not specified for an entity, the specific precondition expression 
for the entity is the enumeration literal True.<A NAME="I3340"></A><A NAME="I3341"></A></div>
<div class="paranum"><a name="p3">3/3</a></div>
<div class="WideHanging-Term">Pre'Class</div><div class="WideHanging-Body">
This aspect specifies a class-wide precondition for an operation of a 
tagged type and its descendants; it shall be specified by an <SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN>, 
called a <I>class-wide precondition expression</I>.<A NAME="I3342"></A><A NAME="I3343"></A> 
If not specified for an entity, then if no other class-wide precondition 
applies to the entity, the class-wide precondition expression for the 
entity is the enumeration literal True.<A NAME="I3344"></A><A NAME="I3345"></A></div>
<div class="paranum"><a name="p4">4/3</a></div>
<div class="WideHanging-Term">Post</div><div class="WideHanging-Body">
This aspect specifies a specific postcondition for a callable entity; 
it shall be specified by an <SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN>, 
called a <I>specific postcondition expression</I>.<A NAME="I3346"></A><A NAME="I3347"></A> 
If not specified for an entity, the specific postcondition expression 
for the entity is the enumeration literal True.<A NAME="I3348"></A><A NAME="I3349"></A></div>
<div class="paranum"><a name="p5">5/3</a></div>
<div class="WideHanging-Term">Post'Class</div><div class="WideHanging-Body">
This aspect specifies a class-wide postcondition for an operation of 
a tagged type and its descendants; it shall be specified by an <SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN>, 
called a <I>class-wide postcondition expression</I>.<A NAME="I3350"></A><A NAME="I3351"></A> 
If not specified for an entity, the class-wide postcondition expression 
for the entity is the enumeration literal True.<A NAME="I3352"></A><A NAME="I3353"></A> 
</div>

<H4 Class="centered">Name Resolution Rules</H4>
<div class="paranum"><a name="p6">6/3</a></div>
<div class="Normal">The expected type for a precondition or postcondition 
expression is any boolean type.<A NAME="I3354"></A><A NAME="I3355"></A></div>
<div class="paranum"><a name="p7">7/3</a></div>
<div class="Normal">Within the expression for a Pre'Class or Post'Class 
aspect for a primitive subprogram of a tagged type <I>T</I>, a name that 
denotes a formal parameter of type <I>T</I> is interpreted as having 
type <I>T</I>'Class. Similarly, a name that denotes a formal access parameter 
of type access-to-<I>T</I> is interpreted as having type access-to-<I>T</I>'Class. 
This ensures that the expression is well-defined for a primitive subprogram 
of a type descended from <I>T</I>.</div>
<div class="paranum"><a name="p8">8/3</a></div>
<div class="Normal">For an attribute_reference with attribute_designator 
Old, if the attribute reference has an expected type or shall resolve 
to a given type, the same applies to the <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN>; 
otherwise, the <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
shall be resolved independently of context.</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum"><a name="p9">9/3</a></div>
<div class="Normal">The Pre or Post aspect shall not be specified for 
an abstract subprogram or a null procedure. Only the Pre'Class and Post'Class 
aspects may be specified for such a subprogram.</div>
<div class="paranum"><a name="p10">10/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;If a type <I>T</I> 
has an implicitly declared subprogram <I>P</I> inherited from a parent 
type <I>T1</I> and a homograph (see <A HREF="RM-8-3.html">8.3</A>) of 
<I>P</I> from a progenitor type <I>T2</I>, and</div>
<div class="paranum"><a name="p11">11/3</a></div>
<div class="Bulleted">the corresponding primitive subprogram <I>P1</I> 
of type <I>T1</I> is neither null nor abstract; and</div>
<div class="paranum"><a name="p12">12/3</a></div>
<div class="Bulleted">the class-wide precondition expression True does 
not apply to <I>P1</I> (implicitly or explicitly); and</div>
<div class="paranum"><a name="p13">13/3</a></div>
<div class="Bulleted">there is a class-wide precondition expression that 
applies to the corresponding primitive subprogram <I>P2</I> of <I>T2</I> 
that does not fully conform to any class-wide precondition expression 
that applies to <I>P1</I>,&nbsp;</div>
<div class="paranum"><a name="p14">14/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;then:</div>
<div class="paranum"><a name="p15">15/3</a></div>
<div class="Bulleted">If the type <I>T</I> is abstract, the implicitly 
declared subprogram <I>P</I> is <I>abstract</I>.</div>
<div class="paranum"><a name="p16">16/3</a></div>
<div class="Bulleted">Otherwise, the subprogram <I>P</I> <I>requires 
overriding</I> and shall be overridden with a nonabstract subprogram.<A NAME="I3356"></A></div>
<div class="paranum"><a name="p17">17/3</a></div>
<div class="Normal">&nbsp;If a renaming of a subprogram or entry <I>S1</I> 
overrides an inherited subprogram <I>S2</I>, then the overriding is illegal 
unless each class-wide precondition expression that applies to <I>S1</I> 
fully conforms to some class-wide precondition expression that applies 
to <I>S2</I> and each class-wide precondition expression that applies 
to <I>S2</I> fully conforms to some class-wide precondition expression 
that applies to <I>S1</I>.</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p18">18/3</a></div>
<div class="Normal">&nbsp;If a Pre'Class or Post'Class aspect is specified 
for a primitive subprogram of a tagged type <I>T</I>, then the associated 
expression also applies to the corresponding primitive subprogram of 
each descendant of <I>T</I>.</div>
<div class="paranum"><a name="p19">19/3</a></div>
<div class="Normal">&nbsp;If performing checks is required by the Pre, Pre'Class, 
Post, or Post'Class assertion policies (see <A HREF="RM-11-4-2.html">11.4.2</A>) 
in effect at the point of a corresponding aspect specification applicable 
to a given subprogram or entry, then the respective precondition or postcondition 
expressions are considered <I>enabled</I>.<A NAME="I3357"></A><A NAME="I3358"></A></div>
<div class="paranum"><a name="p20">20/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;An <SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN> 
is <I>potentially unevaluated</I> if it occurs within:<A NAME="I3359"></A></div>
<div class="paranum"><a name="p21">21/3</a></div>
<div class="Bulleted">any part of an <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0134">if_expression</A></SPAN> 
other than the first <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0135">condition</A></SPAN>;</div>
<div class="paranum"><a name="p22">22/3</a></div>
<div class="Bulleted">a <I>dependent_</I><SPAN Class="swiss"><A HREF="RM-4-4.html#S0117">expression</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0136">case_expression</A></SPAN>;</div>
<div class="paranum"><a name="p23">23/3</a></div>
<div class="Bulleted">the right operand of a short-circuit control form; 
or</div>
<div class="paranum"><a name="p24">24/3</a></div>
<div class="Bulleted">a <SPAN Class="swiss"><A HREF="RM-4-4.html#S0122">membership_choice</A></SPAN> 
other than the first of a membership operation.&nbsp;</div>
<div class="paranum"><a name="p25">25/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;For a <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
X that denotes an object of a nonlimited type, the following attribute 
is defined:&nbsp;</div>
<div class="paranum"><a name="p26">26/3</a></div>
<div class="WideHanging-Term">&nbsp;X'Old</div><div class="WideHanging-Body">
<A NAME="I3360"></A><A NAME="I3361"></A>For each X'Old in a postcondition 
expression that is enabled, a constant is implicitly declared at the 
beginning of the subprogram or entry. The constant is of the type of 
X and is initialized to the result of evaluating X (as an expression) 
at the point of the constant declaration. The value of X'Old in the postcondition 
expression is the value of this constant; the type of X'Old is the type 
of X. These implicit constant declarations occur in an arbitrary order.<A NAME="I3362"></A></div>
<div class="paranum"><a name="p27">27/3</a></div>
<div class="WideHanging-Body">Reference to this attribute is only allowed 
within a postcondition expression. The <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
of an Old <SPAN Class="swiss"><A HREF="RM-4-1-4.html#S0100">attribute_reference</A></SPAN> 
shall not contain a Result <SPAN Class="swiss"><A HREF="RM-4-1-4.html#S0100">attribute_reference</A></SPAN>, 
nor an Old <SPAN Class="swiss"><A HREF="RM-4-1-4.html#S0100">attribute_reference</A></SPAN>, 
nor a use of an entity declared within the postcondition expression but 
not within <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
itself (for example, the loop parameter of an enclosing <SPAN Class="swiss"><A HREF="RM-4-5-8.html#S0138">quantified_expression</A></SPAN>). 
The <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
of an Old <SPAN Class="swiss"><A HREF="RM-4-1-4.html#S0100">attribute_reference</A></SPAN> 
that is potentially unevaluated shall statically denote an entity.</div>
<div class="paranum"><a name="p28">28/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;For a <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
F that denotes a function declaration, the following attribute is defined: 
</div>
<div class="paranum"><a name="p29">29/3</a></div>
<div class="WideHanging-Term">&nbsp;F'Result</div><div class="WideHanging-Body">
<A NAME="I3363"></A><A NAME="I3364"></A>Within a postcondition expression 
for function F, denotes the result object of the function. The type of 
this attribute is that of the function result except within a Post'Class 
postcondition expression for a function with a controlling result or 
with a controlling access result. For a controlling result, the type 
of the attribute is <I>T</I>'Class, where <I>T</I> is the function result 
type. For a controlling access result, the type of the attribute is an 
anonymous access type whose designated type is <I>T</I>'Class, where 
<I>T</I> is the designated type of the function result type.</div>
<div class="paranum"><a name="p30">30/3</a></div>
<div class="WideHanging-Body">Use of this attribute is allowed only within 
a postcondition expression for F.&nbsp;</div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum"><a name="p31">31/3</a></div>
<div class="Normal">&nbsp;Upon a call of the subprogram or entry, after evaluating 
any actual parameters, precondition checks are performed as follows:</div>
<div class="paranum"><a name="p32">32/3</a></div>
<div class="Bulleted">The specific precondition check begins with the 
evaluation of the specific precondition expression that applies to the 
subprogram or entry, if it is enabled; if the expression evaluates to 
False, Assertions.Assertion_Error is raised; if the expression is not 
enabled, the check succeeds.<A NAME="I3365"></A><A NAME="I3366"></A><A NAME="I3367"></A></div>
<div class="paranum"><a name="p33">33/3</a></div>
<div class="Bulleted">The class-wide precondition check begins with the 
evaluation of any enabled class-wide precondition expressions that apply 
to the subprogram or entry. If and only if all the class-wide precondition 
expressions evaluate to False, Assertions.Assertion_Error is raised.<A NAME="I3368"></A><A NAME="I3369"></A><A NAME="I3370"></A></div>
<div class="paranum"><a name="p34">34/3</a></div>
<div class="Normal">&nbsp;The precondition checks are performed in an arbitrary 
order, and if any of the class-wide precondition expressions evaluate 
to True, it is not specified whether the other class-wide precondition 
expressions are evaluated. The precondition checks and any check for 
elaboration of the subprogram body are performed in an arbitrary order. 
It is not specified whether in a call on a protected operation, the checks 
are performed before or after starting the protected action. For an entry 
call, the checks are performed prior to checking whether the entry is 
open.<A NAME="I3371"></A><A NAME="I3372"></A></div>
<div class="paranum"><a name="p35">35/3</a></div>
<div class="Normal">&nbsp;Upon successful return from a call of the subprogram 
or entry, prior to copying back any by-copy <B>in out</B> or <B>out</B> 
parameters, the postcondition check is performed. This consists of the 
evaluation of any enabled specific and class-wide postcondition expressions 
that apply to the subprogram or entry. If any of the postcondition expressions 
evaluate to False, then Assertions.Assertion_Error is raised. The postcondition 
expressions are evaluated in an arbitrary order, and if any postcondition 
expression evaluates to False, it is not specified whether any other 
postcondition expressions are evaluated. The postcondition check, and 
any constraint or predicate checks associated with <B>in out</B> or <B>out</B> 
parameters are performed in an arbitrary order.<A NAME="I3373"></A><A NAME="I3374"></A><A NAME="I3375"></A><A NAME="I3376"></A><A NAME="I3377"></A></div>
<div class="paranum"><a name="p36">36/3</a></div>
<div class="Normal">&nbsp;If a precondition or postcondition check fails, 
the exception is raised at the point of the call; the exception cannot 
be handled inside the called subprogram or entry. Similarly, any exception 
raised by the evaluation of a precondition or postcondition expression 
is raised at the point of call.</div>
<div class="paranum"><a name="p37">37/3</a></div>
<div class="Normal">&nbsp;For any subprogram or entry call (including dispatching 
calls), the checks that are performed to verify specific precondition 
expressions and specific and class-wide postcondition expressions are 
determined by those for the subprogram or entry actually invoked. Note 
that the class-wide postcondition expressions verified by the postcondition 
check that is part of a call on a primitive subprogram of type <I>T</I> 
includes all class-wide postcondition expressions originating in any 
progenitor of <I>T</I>, even if the primitive subprogram called is inherited 
from a type <I>T1</I> and some of the postcondition expressions do not 
apply to the corresponding primitive subprogram of <I>T1</I>.</div>
<div class="paranum"><a name="p38">38/3</a></div>
<div class="Normal">&nbsp;The class-wide precondition check for a call to 
a subprogram or entry consists solely of checking the class-wide precondition 
expressions that apply to the denoted callable entity (not necessarily 
the one that is invoked).</div>
<div class="paranum"><a name="p39">39/3</a></div>
<div class="Normal">&nbsp;For a call via an access-to-subprogram value, all 
precondition and postcondition checks performed are determined by the 
subprogram or entry denoted by the prefix of the Access attribute reference 
that produced the value.&nbsp;</div>
<div class="NotesHeader">NOTES</div>
<div class="paranum"><a name="p40">40/3</a></div>
<div class="Notes">5&nbsp;&nbsp;A precondition is checked just before 
the call. If another task can change any value that the precondition 
expression depends on, the precondition need not hold within the subprogram 
or entry body.&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-6-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-6-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
