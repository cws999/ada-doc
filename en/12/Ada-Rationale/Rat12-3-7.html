<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Qualified expressions</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-bottom: 0.6em}
    DIV.SwissExamples {font-family: Arial, Helvetica, sans-serif; font-size: 90%; line-height: 122%; margin-left: 2.2em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<H1 Style='font-family: "Rockwell", "Times New Roman", Times, serif; font-size: 240%'><B><SPAN Style="color:rgb(0,0,153)">Rationale</SPAN> for <SPAN Style="color:rgb(0,153,51)">Ada 2012</SPAN></B></H1>
<DIV Class="Normal"><FONT SIZE="+1"><I><A HREF="Rat12-TTL.html">John Barnes</A></I></FONT></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="Rat12-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-0-3.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-3-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>3.7 Qualified expressions</H1>
<div class="Normal">We conclude this discussion of expressions by considering 
some points regarding <SPAN Class="swiss">name</SPAN>s and <SPAN Class="swiss">primary</SPAN>s. 
<A NAME="I1328"></A></div>
<div class="Normal" style="margin-bottom: 0.4em">In Ada 2005 we have</div>
<div class="SwissExamples"><SPAN Class="swiss">name</SPAN>&nbsp;::=<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="swiss">direct_name</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">explicit_dereference</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">indexed_component</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">slice</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">selected_component</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">attribute_reference</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">type_conversion</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">function_call</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">character_literal</SPAN></div>
<div class="SwissExamples"><SPAN Class="swiss">primary</SPAN>&nbsp;::=<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="swiss">numeric_literal</SPAN>&nbsp;|&nbsp;<SPAN Class="roman"><B>null</B></SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">string_literal</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">aggregate</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">name</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">qualified_expression</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">allocator</SPAN>&nbsp;|&nbsp;(<SPAN Class="swiss">expression</SPAN>)]</div>
<div class="Normal" style="margin-bottom: 0.4em">And in Ada 2012 we 
have</div>
<div class="SwissExamples"><SPAN Class="swiss">name</SPAN>&nbsp;::=<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="swiss">direct_name</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">explicit_dereference</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">indexed_component</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">slice</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">selected_component</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">attribute_reference</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">type_conversion</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">function_call</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">character_literal</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">qualified_expression</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">generalized_reference</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">generalized_indexing</SPAN></div>
<div class="SwissExamples"><SPAN Class="swiss">primary</SPAN>&nbsp;::=<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="swiss">numeric_literal</SPAN>&nbsp;|&nbsp;<SPAN Class="roman"><B>null</B></SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">string_literal</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">aggregate</SPAN>&nbsp;|&nbsp;<SPAN Class="swiss">name</SPAN><BR>
&nbsp;&nbsp;|&nbsp;<SPAN Class="swiss">allocator</SPAN>&nbsp;|&nbsp;(<SPAN Class="swiss">expression</SPAN>)]<BR>
&nbsp;&nbsp;|&nbsp;(<SPAN Class="swiss">conditional_expression</SPAN>)&nbsp;|&nbsp;(<SPAN Class="swiss">quantified_expression</SPAN>)</div>
<div class="Normal">The important thing to observe here is that <SPAN Class="swiss">qualified_expression</SPAN> 
has moved from being a form of <SPAN Class="swiss">primary</SPAN> to 
being a <SPAN Class="swiss">name</SPAN>.</div>
<div class="Normal">We also note the addition of <SPAN Class="swiss">conditional_expression</SPAN> 
and <SPAN Class="swiss">quantified_expression</SPAN> (both in parentheses) 
as forms of <SPAN Class="swiss">primary</SPAN> as discussed earlier in 
this chapter and the addition of <SPAN Class="swiss">generalized_reference</SPAN> 
and <SPAN Class="swiss">generalized_indexing</SPAN> as forms of name. 
These are used in the new forms of <SPAN Class="swiss">iterator</SPAN> 
briefly alluded to at the end of the discussion on quantified expressions 
and which will be discussed in Section <A HREF="Rat12-6-3.html">6.3</A>.</div>
<div class="Normal">Returning to qualified expressions, the main reason 
for allowing them as <SPAN Class="swiss">name</SPAN>s is to avoid unnecessary 
conversions as mentioned in the Introduction (see <A HREF="Rat12-1-3-2.html">1.3.2</A>).</div>
<div class="Normal" style="margin-bottom: 0.4em">Consider</div>
<div class="SwissExamples">A:&nbsp;T;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>object&nbsp;of&nbsp;type&nbsp;T</I></SPAN><BR>
<B>type</B>&nbsp;Art&nbsp;<B>is&nbsp;array</B>&nbsp;(1&nbsp;..&nbsp;10)&nbsp;<B>of</B>&nbsp;T;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>array&nbsp;of&nbsp;type&nbsp;T</I></SPAN><BR>
<B>function</B>&nbsp;F(X:&nbsp;Integer)&nbsp;<B>return</B>&nbsp;Art;</div>
<div class="Normal" style="margin-bottom: 0.4em">A function call can 
be used as a <SPAN Class="swiss">prefix</SPAN> and so a call returning 
an array can be indexed as in</div>
<div class="SwissExamples">A&nbsp;:=&nbsp;F(3)(7);</div>
<div class="Normal">which assigns to <SPAN Class="swiss">A</SPAN> the 
value of the 7th component of the array returned by the call of <SPAN Class="swiss">F</SPAN>.</div>
<div class="Normal" style="margin-bottom: 0.4em">Now suppose that <SPAN Class="swiss">F</SPAN> 
is overloaded so that <SPAN Class="swiss">F(3)</SPAN> is ambiguous. The 
normal solution to such ambiguities is to use qualification and write 
<SPAN Class="swiss">Art'(F(3))</SPAN> as in</div>
<div class="SwissExamples">A&nbsp;:=&nbsp;Art'(F(3))(7);&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>illegal&nbsp;in&nbsp;Ada&nbsp;2005</I></SPAN></div>
<div class="Normal" style="margin-bottom: 0.4em">but this is illegal 
in Ada 2005 because a qualified expression is not a <SPAN Class="swiss">name</SPAN> 
and so cannot be used as a <SPAN Class="swiss">prefix</SPAN>. What one 
has to do in Ada 2005 is either copy the wretched array (really naughty) 
or add a type conversion (a type conversion <I>is</I> a <SPAN Class="swiss">name</SPAN>) 
thus</div>
<div class="SwissExamples">A&nbsp;:=&nbsp;Art(Art'(F(3)))(7);</div>
<div class="Normal" style="margin-bottom: 0.4em">This is really gruesome; 
but in Ada 2012, qualification is permitted as a <SPAN Class="swiss">name</SPAN> 
so we can simply write</div>
<div class="SwissExamples">A&nbsp;:=&nbsp;Art'(F(3))(7);&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>OK&nbsp;in&nbsp;Ada&nbsp;2012</I></SPAN></div>
<div class="Normal">Although a qualified expression is now classed as 
a <SPAN Class="swiss">name</SPAN> rather than a <SPAN Class="swiss">primary</SPAN>, 
a qualified variable is not considered to be a variable. As a consequence, 
a qualified variable cannot be used as the destination of an assignment 
or as an actual parameter corresponding to an <B>out</B> or <B>in out</B> 
parameter. This would have added complexity for no useful purpose. Ambiguity 
generally involves calls on overloaded functions, and the result of a 
function call is always a constant, so ambiguous names of variables are 
unlikely!</div>
<div class="Normal" style="margin-bottom: 0.4em">Other uses might involve 
strings which can also give rise to ambiguities. For example</div>
<div class="SwissExamples">(&quot;a&nbsp;string&quot;)'Length</div>
<div class="Normal">is ambiguous (it could be a <SPAN Class="swiss">String</SPAN> 
or <SPAN Class="swiss">Wide_String</SPAN>).</div>
<div class="Normal" style="margin-bottom: 0.4em">But now we can write</div>
<div class="SwissExamples">String'(&quot;a&nbsp;string&quot;)'Length</div>
<div class="Normal">which was not permitted in Ada 2005.</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="Rat12-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-0-3.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-3-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="Rat12-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Class="Normal">&copy; 2011, 2012, 2013 John Barnes Informatics.</DIV>
<DIV Class="Normal">Sponsored in part by:</DIV>
<TABLE Summary="Sponsors" Width="800">
<TR><TD Width="250" Align="Center" VAlign="Top">
<SPAN Style="font-family: Arial, Helvetica, sans-serif; font-size: 92%">The <b><A HREF="http://www.adaic.org/community/">Ada Resource Association</A></b>:<BR><BR>
&nbsp;&nbsp;&nbsp; <A HREF="http://www.adaic.org"><IMG SRC="aralogo.gif" ALT="ARA" Height="120" Border="0"></A></SPAN>
</TD>
<TD Width="300" Align="Center" VAlign="Top">
<SPAN Style="font-family: Arial, Helvetica, sans-serif; font-size: 92%">&nbsp; <b><A HREF="http://www.adacore.com">AdaCore</A></b>:<BR><BR><BR>
&nbsp;&nbsp;&nbsp; <A HREF="http://www.adacore.com"><IMG SRC="adacore.gif" ALT="AdaCore" Height="80" Border="0"></A></SPAN>
</TD>
<TD Width="250" Align="Center" VAlign="Top">
<SPAN Style="font-family: Arial, Helvetica, sans-serif; font-size: 92%">and &nbsp; <b><A HREF="http://www.ada-europe.org">Ada-Europe</A></b>:<BR><BR>
<A HREF="http://www.ada-europe.org"><IMG SRC="AE_logo.gif" ALT="Ada-Europe" Height="128" Border="0"></A></SPAN>
</TD></TR>
</TABLE>
</BODY>
</HTML>
